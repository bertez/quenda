/**
 * quenda - A simple javascript function queue.
 * @version v0.0.1
 * @author Berto Yáñez <berto@ber.to>
 * @homepage https://github.com/bertez/quenda
 * @license MIT
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["merge"],t):"object"==typeof module&&module.exports?module.exports=t(require("merge")):e.Quenda=t(e.merge)}(this,function(e){"use strict";var t={loop:!1,maxLoops:1/0},n={queues:[],prototype:{add:function(e){if(!e)throw new Error("Not enough arguments");if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else{if(e.nextDelay&&e.nextDelay<0)throw new Error("nextDelay property must be greater than 0");if(e.fn&&"function"!=typeof e.fn)throw new Error("The property fn must be a function");if(e.autoDestroy&&"boolean"!=typeof e.autoDestroy)throw new Error("The property autoDestroy must be a boolean");this.steps.push(e)}return this},play:function(){return this._execute(this._current),this},pause:function(){return this._currentTimeout&&clearTimeout(this._currentTimeout),this},next:function(){return this.pause(),this._current++,this.play(),this},prev:function(){return this.pause(),this._current--,this.play(),this},_current:0,loops:0,_execute:function(e){var t;if(this.steps[e])t=this.steps[this._current];else{if(!(this.config.loop&&this.loops<this.config.maxLoops))return!1;this.loops++,t=this.steps[this._current=0]}if(t.preload&&!t.preloaded?this._handlePreload(t.preload,function(){this._setNextTimeout(t.nextDelay),t.preloaded=!0,t.fn&&t.fn()}.bind(this)):(this._setNextTimeout(t.nextDelay),t.fn&&t.fn()),t.autoDestroy){var n=this.steps.indexOf(t);this._current=n,this.steps.splice(n,1)}},_setNextTimeout:function(e){var t=e||this.config.defaultDelay;t&&(this._currentTimeout=setTimeout(function(){this._execute(++this._current)}.bind(this),e))},_handlePreload:function(e,t){var n=0;e.forEach(function(r){var i=new Image;i.onload=function(){++n,n===e.length&&t()},i.src=r})}},getAll:function(){return this.queues},deleteAll:function(){return this.getAll().forEach(function(e){e.instance.pause()}),this.queues=[],this},"delete":function(e){var t=this.queues.splice(e,1);return t[0].instance.pause(),this},"new":function(n,r){if(n&&n!==Object(n))throw new Error("Config object should be a key/value object.");var i=Object.create(this.prototype);return this.queues.push(r?{name:r,instance:i}:{instance:i}),e(i,{config:e({},t,n),steps:[]}),i}};return n.fn=n.prototype,n.version="0.0.1",n});