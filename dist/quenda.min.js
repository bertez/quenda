/**
 * quenda - A simple javascript function queue.
 * @version v1.0.0
 * @author Berto Yáñez <berto@ber.to>
 * @homepage https://github.com/bertez/quenda
 * @license MIT
 */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["merge"],e):"object"==typeof module&&module.exports?module.exports=e(require("merge")):t.Quenda=e(t.merge)}(this,function(t){"use strict";var e={queues:[],prototype:{add:function(t){if(!t)throw new Error("Not enough arguments");if(Array.isArray(t))t.forEach(function(t){this.add(t)},this);else{if(t.nextDelay&&t.nextDelay<0)throw new Error("nextDelay property must be greater than 0");if(t.fn&&"function"!=typeof t.fn)throw new Error("The property fn must be a function");if(t.autoDestroy&&"boolean"!=typeof t.autoDestroy)throw new Error("The property autoDestroy must be a boolean");this.steps.push(t)}return this},play:function(){return this._execute(this._current),this},pause:function(){return this._currentTimeout&&clearTimeout(this._currentTimeout),this},next:function(){return this.pause(),this._current++,this.play(),this},prev:function(){return this.pause(),this._current--,this.play(),this},_current:0,loops:0,playing:!1,_execute:function(t){var e;if(this.steps[t])e=this.steps[this._current];else{if(!(this.config.loop&&this.loops<this.config.maxLoops))return!1;this.loops++,e=this.steps[this._current=0]}if(e.preload&&!e.preloaded?this._handlePreload(e.preload,function(){this._setNextTimeout(e.nextDelay),e.preloaded=!0,e.fn&&e.fn.call(this,e)}.bind(this)):(this._setNextTimeout(e.nextDelay),e.fn&&e.fn.call(this,e)),e.autoDestroy){var n=this.steps.indexOf(e);this._current=n,this.steps.splice(n,1)}},_setNextTimeout:function(t){var e=t||this.config.defaultDelay;e&&(this._currentTimeout=setTimeout(function(){this._execute(++this._current)}.bind(this),e))},_handlePreload:function(t,e){var n=0;t.forEach(function(r){var i=new Image;i.onload=function(){++n,n===t.length&&e()},i.src=r})}},getAll:function(){return this.queues},deleteAll:function(){return this.getAll().forEach(function(t){t.instance.pause()}),this.queues=[],this},"delete":function(t){var e=this.queues.splice(t,1);return e[0].instance.pause(),this},"new":function(e,n){if(e&&e!==Object(e))throw new Error("Config object should be a key/value object.");var r={loop:!1,maxLoops:1/0},i=Object.create(this.prototype);return this.queues.push(n?{name:n,instance:i}:{instance:i}),t(i,{config:t({},r,e),steps:[]}),i}};return e.fn=e.prototype,e.version="1.0.0",e});